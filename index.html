
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ton Test PCM</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      color: #1d1d1f;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      padding: 40px;
      margin-top: 20px;
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #007AFF, #5856D6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      text-align: center;
      font-size: 1.1rem;
      color: #86868b;
      margin-bottom: 40px;
      font-weight: 400;
    }

    .question {
      background: #ffffff;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border: 1px solid rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
    }

    .question:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .question-number {
      display: inline-block;
      background: linear-gradient(135deg, #007AFF, #5856D6);
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      text-align: center;
      line-height: 32px;
      font-weight: 600;
      font-size: 0.9rem;
      margin-right: 12px;
      margin-bottom: 8px;
    }

    .question-text {
      font-size: 1rem;
      font-weight: 500;
      margin-bottom: 16px;
      color: #1d1d1f;
    }

    .radio-group {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .radio-option {
      position: relative;
      display: flex;
      align-items: center;
      cursor: pointer;
    }

    .radio-option input[type="radio"] {
      appearance: none;
      width: 20px;
      height: 20px;
      border: 2px solid #d2d2d7;
      border-radius: 50%;
      margin-right: 8px;
      position: relative;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .radio-option input[type="radio"]:checked {
      border-color: #007AFF;
      background: #007AFF;
    }

    .radio-option input[type="radio"]:checked::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 8px;
      height: 8px;
      background: white;
      border-radius: 50%;
    }

    .radio-option label {
      font-size: 0.95rem;
      color: #1d1d1f;
      cursor: pointer;
      font-weight: 500;
    }

    .submit-btn {
      background: linear-gradient(135deg, #007AFF, #5856D6);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: block;
      margin: 40px auto 0;
      box-shadow: 0 8px 20px rgba(0, 122, 255, 0.3);
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(0, 122, 255, 0.4);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .resultat {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      border-radius: 20px;
      padding: 32px;
      margin-top: 40px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(0, 0, 0, 0.05);
      text-align: center;
    }

    .resultat h2 {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #007AFF, #5856D6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .resultat p {
      font-size: 1.1rem;
      margin-bottom: 12px;
      color: #1d1d1f;
    }

    .resultat strong {
      color: #007AFF;
      font-weight: 600;
    }

    .score-badge {
      display: inline-block;
      background: linear-gradient(135deg, #007AFF, #5856D6);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      margin-left: 8px;
    }

    .export-btn {
      background: linear-gradient(135deg, #34C759, #30D158);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-left: 12px;
    }

    .export-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(52, 199, 89, 0.4);
    }

    .export-btn:active {
      transform: translateY(0);
    }

    .image-preview {
      margin-top: 20px;
      text-align: center;
    }

    .image-preview img {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      border: 2px solid rgba(0, 0, 0, 0.05);
    }

    .download-link {
      display: inline-block;
      margin-top: 15px;
      padding: 10px 20px;
      background: linear-gradient(135deg, #007AFF, #5856D6);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .download-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 122, 255, 0.4);
    }

    .hidden { 
      display: none; 
    }

    @media (max-width: 768px) {
      .container {
        padding: 20px;
        margin: 10px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .radio-group {
        flex-direction: column;
        gap: 12px;
      }
      
      .question {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Test PCM</h1>
    <p class="subtitle">Ce test est conÃ§u pour mieux comprendre votre style de communication, vos besoins psychologiques et vos rÃ©actions sous stress. Il nâ€™y a pas de bonnes ou de mauvaises rÃ©ponses : rÃ©pondez de faÃ§on spontanÃ©e et honnÃªte.

      Pour chaque affirmation, indiquez Ã  quel point elle vous correspond : <br>
      <br>
      ðŸ”´ 1 = Pas du tout vrai
      ðŸŸ  2 = PlutÃ´t faux
      ðŸŸ¡ 3 = PlutÃ´t vrai
      ðŸŸ¢ 4 = Tout Ã  fait vrai
    
    </p>
    <form id="testPCM">
      <div id="questions"></div>
      <button type="submit" class="submit-btn">Voir mon profil dominant</button>
    </form>
    <div class="resultat hidden" id="resultat"></div>
  </div>

  <script>
    const types = [
      'PenseurÂ·se', 'Empathique', 'Rebelle', 'PromoteurÂ·rice', 'RÃªveurÂ·se', 'PersÃ©vÃ©rantÂ·e'
    ];

    const affirmations = [
      // 10 par type
      ["J'aime planifier les choses Ã  l'avance.", "Je me sens bien quand mon environnement est bien structurÃ©.", "Je prends des dÃ©cisions rationnelles basÃ©es sur des faits.", "J'organise mes journÃ©es selon un horaire.", "Je suis Ã  l'aise avec les chiffres, les systÃ¨mes ou les procÃ©dures.", "Je suis ponctuelÂ·le et fiable.", "J'ai besoin que les choses soient bien expliquÃ©es.", "J'ai tendance Ã  analyser les situations en profondeur.", "Je suis plus Ã  l'aise dans un cadre clair et prÃ©visible.", "Je prÃ©fÃ¨re les Ã©changes professionnels aux discussions trop personnelles."],
      ["J'aime aider les autres Ã  se sentir mieux.", "Je suis facilement Ã©muÂ·e par les histoires des autres.", "Je prÃ©fÃ¨re un environnement de travail bienveillant Ã  un cadre strict.", "Je suis trÃ¨s attentifÂ·ve aux Ã©motions des autres.", "J'ai besoin de me sentir aimÃ©Â·e ou apprÃ©ciÃ©Â·e.", "Je suis sensible aux conflits dans une Ã©quipe.", "Je valorise l'harmonie avant tout.", "Je prends souvent soin des autres.", "Mon bien-Ãªtre dÃ©pend de mes relations humaines.", "J'ai du mal Ã  cacher mes Ã©motions."],
      ["J'aime improviser plutÃ´t que suivre un plan rigide.", "Je suis crÃ©atifÂ·ve et j'aime trouver des solutions originales.", "J'ai besoin de m'amuser pour Ãªtre motivÃ©Â·e.", "Je me lasse rapidement de la routine.", "J'ai un humour un peu dÃ©calÃ©.", "Je rÃ©agis au feeling plus qu'Ã  la logique.", "Je pose des questions parfois 'hors cadre'.", "Je prÃ©fÃ¨re la lÃ©gÃ¨retÃ© Ã  la lourdeur des procÃ©dures.", "Je cherche souvent Ã  casser les codes.", "Je suis Ã©nergique et expressifÂ·ve dans mes rÃ©actions."],
      ["J'aime prendre des risques calculÃ©s.", "Je prÃ©fÃ¨re passer Ã  l'action plutÃ´t que rÃ©flÃ©chir trop longtemps.", "J'ai une grande confiance en moi.", "Je suis compÃ©titifÂ·ve et motivÃ©Â·e par les rÃ©sultats.", "Je me sens Ã  l'aise dans des situations de crise.", "Je suis Ã  l'aise dans les environnements instables.", "J'aime convaincre les autres de mes idÃ©es.", "Je m'adapte rapidement aux imprÃ©vus.", "Je prÃ©fÃ¨re travailler seulÂ·e et efficacement que trop en Ã©quipe.", "Je fonctionne bien sous pression."],
      ["J'ai besoin de temps seulÂ·e pour me ressourcer.", "Je prÃ©fÃ¨re observer avant d'agir.", "Je me sens bien dans un environnement silencieux.", "Je suis souvent perduÂ·e dans mes pensÃ©es.", "Je prÃ©fÃ¨re qu'on me donne des consignes claires.", "Je me sens dÃ©passÃ©Â·e quand tout va trop vite.", "J'ai une riche vie intÃ©rieure.", "Je suis discretÂ·Ã¨te dans un groupe.", "Je prÃ©fÃ¨re Ã©crire plutÃ´t que parler.", "J'ai besoin d'un environnement stable et paisible."],
      ["Je dÃ©fends mes idÃ©es avec conviction.", "Je suis fidÃ¨le Ã  mes valeurs.", "Je suis trÃ¨s attentifÂ·ve Ã  ce qui est juste ou injuste.", "Je cherche toujours Ã  m'amÃ©liorer.", "Je suis trÃ¨s exigeantÂ·e avec moi-mÃªme.", "J'ai besoin de reconnaissance pour mon engagement.", "Je suis loyalÂ·e envers les causes que je dÃ©fends.", "J'observe beaucoup les comportements des autres.", "Je remarque vite les incohÃ©rences ou les erreurs.", "J'ai besoin de savoir que mon travail a du sens."]
    ];

    const container = document.getElementById("questions");
    affirmations.forEach((bloc, blocIndex) => {
      bloc.forEach((text, i) => {
        const div = document.createElement("div");
        div.className = "question";
        div.innerHTML = `
          <div class="question-number">${(blocIndex*10+i+1).toString().padStart(2, '0')}</div>
          <div class="question-text">${text}</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="q${blocIndex}_${i}" value="1" required>
              <label>1</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="q${blocIndex}_${i}" value="2">
              <label>2</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="q${blocIndex}_${i}" value="3">
              <label>3</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="q${blocIndex}_${i}" value="4">
              <label>4</label>
            </div>
          </div>`;
        container.appendChild(div);
      });
    });

    document.getElementById("testPCM").addEventListener("submit", e => {
      e.preventDefault();
      const resultats = [0, 0, 0, 0, 0, 0];
      for (let bloc = 0; bloc < affirmations.length; bloc++) {
        for (let i = 0; i < affirmations[bloc].length; i++) {
          const val = document.querySelector(`input[name='q${bloc}_${i}']:checked`).value;
          resultats[bloc] += parseInt(val);
        }
      }
      const max = Math.max(...resultats);
      const index = resultats.indexOf(max);
      const secondaire = [...resultats]
        .map((val, i) => ({ val, i }))
        .filter(obj => obj.i !== index)
        .sort((a, b) => b.val - a.val)[0];

      const r = document.getElementById("resultat");
      r.classList.remove("hidden");
      r.innerHTML = `
        <h2>Ton profil dominant : ${types[index]}</h2>
        <p><strong>Score :</strong> <span class="score-badge">${resultats[index]}</span></p>
        <p>Ton profil secondaire : <strong>${types[secondaire.i]}</strong> <span class="score-badge">${secondaire.val}</span></p>
        <div style="text-align: center; margin-top: 30px;">
          <a href="profiles.html?profile=${index}&secondary=${secondaire.i}" class="submit-btn" style="text-decoration: none; display: inline-block;">Voir les dÃ©tails de mon profil</a>
          <button class="export-btn" onclick="exportResults()">
            ðŸ“¸ Exporter en image
          </button>
        </div>
        <div class="image-preview hidden" id="imagePreview"></div>`;
      window.scrollTo({ top: r.offsetTop, behavior: 'smooth' });
    });

    // Export results as PNG image
    function exportResults() {
      const resultat = document.getElementById('resultat');
      const imagePreview = document.getElementById('imagePreview');
      
      // Show loading state
      const exportBtn = document.querySelector('.export-btn');
      const originalText = exportBtn.innerHTML;
      exportBtn.innerHTML = 'ðŸ”„ GÃ©nÃ©ration...';
      exportBtn.disabled = true;

      // Create a temporary container for better image capture
      const tempContainer = document.createElement('div');
      tempContainer.style.cssText = `
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 40px;
        border-radius: 20px;
        max-width: 600px;
        margin: 0 auto;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      `;
      
      // Clone the result content
      const resultClone = resultat.cloneNode(true);
      resultClone.style.cssText = `
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 32px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.05);
        text-align: center;
      `;
      
      // Remove the buttons from the clone
      const buttonsContainer = resultClone.querySelector('div');
      if (buttonsContainer) {
        buttonsContainer.remove();
      }
      
      // Add title to the image
      const title = document.createElement('h1');
      title.innerHTML = 'Test PCM - RÃ©sultats';
      title.style.cssText = `
        text-align: center;
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 20px;
        background: linear-gradient(135deg, #007AFF, #5856D6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      `;
      
      tempContainer.appendChild(title);
      tempContainer.appendChild(resultClone);
      document.body.appendChild(tempContainer);

      // Capture the image
      html2canvas(tempContainer, {
        backgroundColor: null,
        scale: 2,
        useCORS: true,
        allowTaint: true,
        width: 600,
        height: tempContainer.offsetHeight
      }).then(canvas => {
        // Remove temporary container
        document.body.removeChild(tempContainer);
        
        // Convert to blob and create download link
        canvas.toBlob(function(blob) {
          const url = URL.createObjectURL(blob);
          
          // Show preview and download link
          imagePreview.classList.remove('hidden');
          imagePreview.innerHTML = `
            <img src="${url}" alt="RÃ©sultats PCM" />
            <br>
            <a href="${url}" download="resultats-pcm.png" class="download-link">
              ðŸ’¾ TÃ©lÃ©charger l'image
            </a>
          `;
          
          // Reset button
          exportBtn.innerHTML = originalText;
          exportBtn.disabled = false;
          
          // Scroll to preview
          imagePreview.scrollIntoView({ behavior: 'smooth' });
        }, 'image/png');
      }).catch(error => {
        console.error('Error generating image:', error);
        exportBtn.innerHTML = originalText;
        exportBtn.disabled = false;
        alert('Erreur lors de la gÃ©nÃ©ration de l\'image. Veuillez rÃ©essayer.');
      });
    }
  </script>
</body>
</html>
